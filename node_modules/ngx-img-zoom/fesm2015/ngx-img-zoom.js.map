{"version":3,"file":"ngx-img-zoom.js","sources":["ng://ngx-img-zoom/lib/ngx-img-zoom.service.ts","ng://ngx-img-zoom/lib/ngx-img-zoom.component.ts","ng://ngx-img-zoom/lib/ngx-img-zoom.module.ts"],"sourcesContent":["import { Injectable } from '@angular/core';\nimport { NgxImgZoomMode } from './mode.enum';\n\n@Injectable()\nexport class NgxImgZoomService {\n  zoomMode = NgxImgZoomMode.HoverZoom;\n\n  constructor() { }\n\n  setZoomMode(zoomMode) {\n    this.zoomMode = zoomMode;\n  }\n}\n","import { Component, OnInit, Renderer2, ElementRef, ViewChild, AfterViewInit, Input, HostListener } from '@angular/core';\nimport { NgxImgZoomService } from './ngx-img-zoom.service';\nimport { NgxImgZoomMode } from './mode.enum';\n@Component({\n  selector: 'ngx-img-zoom',\n  templateUrl: './ngx-img-zoom.component.html',\n  styleUrls: ['./ngx-img-zoom.component.css'],\n})\nexport class NgxImgZoomComponent implements OnInit, AfterViewInit {\n\n  img; lens; result; cx; cy; container;\n  hide = true;\n  _triggerAnimationIn = false;\n  notFirstTime = false;\n  showResult = false;\n  constructor(\n    private renderer: Renderer2,\n    private ngxZoomService: NgxImgZoomService\n    ) { }\n\n    zoomMode: NgxImgZoomMode = this.ngxZoomService.zoomMode;\n    @ViewChild('img') imgElmRef: ElementRef;\n    @ViewChild('result') resultElmRef: ElementRef;\n    @ViewChild('container') containerElmRef: ElementRef;\n\n\n    _imgStyle;\n    @Input() set imgStyle(val) {\n      this._imgStyle = val;\n    }\n    get imgStyle() {\n      return this._imgStyle;\n    }\n\n    _resultStyle;\n    @Input() set resultStyle(val) {\n      this._resultStyle = val;\n    }\n    get resultStyle() {\n      return this._resultStyle;\n    }\n\n    _lensStyle;\n    @Input() set lensStyle(val) {\n      this._lensStyle = val;\n      if (this.notFirstTime) {\n        this.imageZoom();\n      }\n    }\n    get lensStyle() {\n      return this._lensStyle;\n    }\n    @Input() containerStyle;\n    zoomImage;\n    previewImage;\n\n  @HostListener('window:scroll', ['$event']) onscroll(event) {\n    this.hide = true;\n    this.renderer.setStyle(this.lens, 'visibility', 'hidden');\n  }\n  @HostListener('window:click', ['$event.target']) onclick(event) {\n    this.hide = true;\n    this.renderer.setStyle(this.lens, 'visibility', 'hidden');\n  }\n\n  @Input('zoomImageSrc') set _imgSrc(val) {\n    this.zoomImage = val;\n    if (this.notFirstTime === true) {\n      this.renderer.setStyle(this.result, 'backgroundImage', \"url('\" + val + \"')\");\n    }\n    this.notFirstTime = true;\n    // this.renderer.setStyle(this.result, 'backgroundImage', val);\n  }\n\n  @Input('previewImageSrc') set _zoomImage(val) {\n    this.previewImage = val;\n    this.showResult = false;\n    const image = new Image();\n    image.src = this.zoomImage;\n    image.onload = () => {\n      this.showResult = true;\n    };\n  }\n\n  ngOnInit() {\n  }\n\n  ngAfterViewInit() {\n    this.img = this.imgElmRef.nativeElement;\n    this.result = this.resultElmRef.nativeElement;\n    this.container = this.containerElmRef.nativeElement;\n\n    this.renderer.setAttribute(this.img, 'style', <string>this.imgStyle);\n    this.renderer.setAttribute(this.result, 'style', <string>this.resultStyle);\n    this.renderer.setAttribute(this.container, 'style', <string>this.containerStyle);\n    this.imageZoom();\n    this.renderer.setStyle(this.lens, 'visibility', 'hidden');\n    this.renderer.listen(this.img, 'mouseout', () => {\n      this.hide = true;\n      this.renderer.setStyle(this.lens, 'visibility', 'hidden');\n     });\n  }\n\n\n  imageZoom() {\n    /*create lens:*/\n    this.lens = this.renderer.createElement('DIV');\n    this.renderer.addClass(this.lens, 'img-zoom-lens');\n    this.renderer.setAttribute(this.lens, 'style', <string>this.lensStyle);\n\n    /*insert lens:*/\n    this.renderer.insertBefore(this.img.parentElement, this.lens, this.img);\n\n    /*calculate the ratio between result DIV and lens:*/\n    this.cx = this.result.offsetWidth / this.lens.offsetWidth;\n    this.cy = this.result.offsetHeight / this.lens.offsetHeight;\n\n    /*set background properties for the result DIV:*/\n    this.renderer.setStyle(this.result, 'backgroundImage', \"url('\" + this.zoomImage + \"')\");\n    this.renderer.setStyle(this.result, 'backgroundSize', (this.img.width * this.cx) + 'px ' + (this.img.height * this.cy) + 'px');\n    // this.renderer.setStyle(this.img.parentElement, 'position', 'relative')\n\n    /*execute a function when someone moves the cursor over the image, or the lens:*/\n    this.renderer.listen(this.lens, 'mousemove', this.moveLens.bind(this));\n    this.renderer.listen(this.img, 'mousemove', this.moveLens.bind(this));\n\n    /*and also for touch screens:*/\n    this.renderer.listen(this.img, 'touchmove', this.moveLens.bind(this));\n    this.renderer.listen(this.lens, 'touchmove', this.moveLens.bind(this));\n  }\n\n  moveLens(e) {\n      let pos, x, y;\n      /*prevent any other actions that may occur when moving over the image:*/\n      e.preventDefault();\n      /*get the cursor's x and y positions:*/\n      pos = this.getCursorPos(e);\n      /*calculate the position of the lens:*/\n      x = pos.x - (this.lens.offsetWidth / 2);\n      y = pos.y - (this.lens.offsetHeight / 2);\n\n\n      /*prevent the lens from being positioned outside the image:*/\n      if (x > this.img.width - this.lens.offsetWidth) {\n        x = this.img.width - this.lens.offsetWidth;\n\n        this.hide = true;\n        this.renderer.setStyle(this.lens, 'visibility', 'hidden');\n      } else {\n        this.hide = false;\n        if (this.showResult) {\n          this.renderer.setStyle(this.lens, 'visibility', 'visible');\n        }\n      }\n\n      if (x < 0) {\n        x = 0;\n        this.hide = true;\n        this.renderer.setStyle(this.lens, 'visibility', 'hidden');\n      }\n\n      if (y > this.img.height - this.lens.offsetHeight) {\n        y = this.img.height - this.lens.offsetHeight;\n        this.hide = true;\n        this.renderer.setStyle(this.lens, 'visibility', 'hidden');\n      }\n\n      if (y < 0) {\n        y = 0;\n        this.hide = true;\n        this.renderer.setStyle(this.lens, 'visibility', 'hidden');\n      }\n\n      /*set the position of the lens:*/\n      this.renderer.setStyle(this.lens, 'left', x + 'px');\n      this.renderer.setStyle(this.lens, 'top', y + 'px');\n      /*display what the lens 'sees':*/\n      this.renderer.setStyle(this.result, 'backgroundPosition', '-' + (x * this.cx) + 'px -' + (y * this.cy) + 'px');\n    }\n\n  getCursorPos(e) {\n      let a, x = 0, y = 0;\n      e = e || window.event;\n      /*get the x and y positions of the image:*/\n      a = this.img.getBoundingClientRect();\n      /*calculate the cursor's x and y coordinates, relative to the image:*/\n      x = e.pageX - a.left;\n      y = e.pageY - a.top;\n      /*consider any page scrolling:*/\n      x = x - window.pageXOffset;\n      y = y - window.pageYOffset;\n      return {x : x, y : y};\n  }\n\n  handleMouseLeave() {\n    this.hide = true;\n    this.renderer.setStyle(this.lens, 'visibility', 'hidden');\n  }\n\n}\n","import { NgModule } from '@angular/core';\nimport { NgxImgZoomComponent } from './ngx-img-zoom.component';\nimport { CommonModule } from '@angular/common';\nimport { NgxImgZoomService } from './ngx-img-zoom.service';\n\n@NgModule({\n  imports: [\n    CommonModule\n  ],\n  providers: [NgxImgZoomService],\n  declarations: [NgxImgZoomComponent],\n  exports: [NgxImgZoomComponent]\n})\nexport class NgxImgZoomModule { }\n"],"names":[],"mappings":"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"}